問 題 ⑤

鮮 法 ( 小 課 題 ③)

実 は 、o(⑧“log W) で も 解 く こ と が で き ま す 。 以 下 の こ と を 考 え て み ま し ょ う 。
dpl②|[?] の 値 を dol①l[?] か ら O(V う で 求 め ら れ な い か ?
dpl④][?] の 値 を dol②|[?] か ら O(V う で 求 め ら れ な い か ?
dpl⑧l[?] の 値 を dol④j[?] か ら O(W う で 求 め ら れ な い か ?

実 は 求 め る こ と が で き ま す 。 実 際 、 以 下 の よ う な 選 移 に な る の で す 。
dp[2][(10* x j + k) mod B] += dp[1](j] x dp[1][K]
dp[4][(10° x j + k) mod B] += dp(2](j] x dp[2][k]
dp(8][(10* x j + k) mod B] += dp[4](j] x dp[4][k]

イ メ ー ジ で 考 え る と 、 例 え ぽ “③①④①⑤⑨②@ の 上 ④ 桁 `③①④①」 を ⑩000 倍 し て ⑤⑨②⑥
足 し た ら ③①④①⑤⑨②⑥ に な る 、 と い う 感 じ で す 。 例 え ば ⑧ = ⑰ の 場 合 を 考 え て み ま し ょ
う 。 実 際 に 、③①④① mod ⑰ = ⑬,⑤⑨②⑥ mod ⑰ = ⑩ で す が 、(①③ x ⑩*+

⑩) mod ⑰= ⑪ で あ り 、 こ れ は ③①④①⑤⑨②⑥ mod ⑰ と 一 致 し ま す 。

解 説 (P③)

的 に 高 速 化 で き る 場 合 も あ る

こ の よ う に 、①0①0 う ⑩④ ⑩⑧①0①⑥ ‥ を ⑧ で 割 っ た 余 り を 前 計 算 す る こ と で 、 結 果 的 に 、 ダ ブ リ ン グ の よ う な 手 法 で 全
以 下 の よ う な 感 じ の 実 装 で 0(⑧“log D で 解 け ま す 。 (※) 体 計 算 量 o(⑧②log ) で こ の 問 題 を 解
for (int 1 = 0; i < 60; i++) { く こ と が で き 、 小 課 題 ③ ま で 正 解 す る

for (int j = @; j < B; j++) {

こ と が で き ま し た 。

for (int k = ©; k < Bj k++) {

}
禄 足 説 明 と

int n
DP[i
DP[i

と で 0(Blog Blog N)
よ う な 策 殊 な 値 で は な い の で 一 工 夫 必 要 で す が 、 そ れ で も 例 え ば ③ 種 類 く ら

い mod を

 

ex = (j * powerl@[i] + k) % B; Fads 仁 ュ ム ア イ デ ア ⑧
i cr Ro th な お 、 似 た よ う な ア イ デ ア と し て きた ま

+ ①][nex] % mod; で 法 と い う 手 法 が あ り ま す 。 興 味 の あ
る 人 は 是 非 調 べ て み ま し よ う 。

【 類 題 】

し て 、 な お 、 選 移 部 分 を 高 速 フ ー リ エ 変 換 (FFT) で 高 速 化 す る こ ・ S⑧pc #⑥ FーRandom Shuffles

で 解 く こ と が で き ま す 。mod の 値 が ⑨⑨⑧②④④③⑤③ の ・ TDPC イ ー フ ィ ボ ナ ッ チ

 

 

 

RUTH

 

 

 

h 国 剰 余 定 理 で 復 元 す る 方 法 な ど で 上 手 く い き ま す 。

 

※power①0[i] は ⑩“ mod ⑧ の こ と を 指 し ま す 。 こ れ で 元 々 の dp[①J[?]】, dp[②][?], dp[④][?】, … が 求 ま り ま し た 。

※ サ ン プ ル コ ー ド は GitHub 上 に ア ッ プ ロ ー ド し て い ま す 。 是 非 ご 活 用 く だ さ い 。

 
