{"task_url":"https://atcoder.jp/contests/arc115/tasks/arc115_f","statement":{"HTML":{"html":"<html><head style=\"display: none !important;\"><meta content=\"default-src * 'unsafe-inline' 'unsafe-eval';\" http-equiv=\"Content-Security-Policy\"></meta>\n\t<title style=\"display: none !important;\">F - Migration</title>\n\t<meta style=\"display: none !important;\" http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n\t<meta http-equiv=\"Content-Language\" style=\"display: none !important;\" content=\"en\">\n\t<meta content=\"width=device-width,initial-scale=1.0\" name=\"viewport\" style=\"display: none !important;\">\n\t<meta name=\"format-detection\" content=\"telephone=no\" style=\"display: none !important;\">\n\t<meta name=\"google-site-verification\" style=\"display: none !important;\" content=\"nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM\">\n\n\t\n\t<meta name=\"description\" style=\"display: none !important;\" content=\"AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online.\">\n\t<meta name=\"author\" content=\"AtCoder Inc.\" style=\"display: none !important;\">\n\n\t<meta content=\"AtCoder\" style=\"display: none !important;\" property=\"og:site_name\">\n\t\n\t<meta property=\"og:title\" style=\"display: none !important;\" content=\"F - Migration\">\n\t<meta property=\"og:description\" style=\"display: none !important;\" content=\"AtCoder is a programming contest site for anyone from beginners to experts. We hold weekly programming contests online.\">\n\t<meta property=\"og:type\" content=\"website\" style=\"display: none !important;\">\n\t<meta style=\"display: none !important;\" property=\"og:url\" content=\"https://atcoder.jp/contests/arc115/tasks/arc115_f\">\n\t<meta content=\"https://img.atcoder.jp/assets/atcoder.png\" style=\"display: none !important;\" property=\"og:image\">\n\t<meta name=\"twitter:card\" content=\"summary\" style=\"display: none !important;\">\n\t<meta style=\"display: none !important;\" content=\"@atcoder\" name=\"twitter:site\">\n\t\n\t<meta property=\"twitter:title\" content=\"F - Migration\" style=\"display: none !important;\">\n\n\t<link style=\"display: none !important;\" href=\"//fonts.googleapis.com/css?family=Lato:400,700\" type=\"text/css\" rel=\"stylesheet\">\n\t<link type=\"text/css\" style=\"display: none !important;\" rel=\"stylesheet\" href=\"https://img.atcoder.jp/public/e93c8b9/css/bootstrap.min.css\">\n\t<link href=\"//img.atcoder.jp/public/e93c8b9/css/base.css\" style=\"display: none !important;\" rel=\"stylesheet\" type=\"text/css\">\n\t<link href=\"//img.atcoder.jp/assets/favicon.png\" style=\"display: none !important;\" type=\"image/png\" rel=\"shortcut icon\">\n\t<link style=\"display: none !important;\" rel=\"apple-touch-icon\" href=\"//img.atcoder.jp/assets/atcoder.png\">\n\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/lib/jquery-1.9.1.min.js\" style=\"display: none !important;\"></script>\n\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/lib/bootstrap.min.js\" style=\"display: none !important;\"></script>\n\t<script style=\"display: none !important;\" src=\"//img.atcoder.jp/public/e93c8b9/js/cdn/js.cookie.min.js\"></script>\n\t<script style=\"display: none !important;\" src=\"//img.atcoder.jp/public/e93c8b9/js/cdn/moment.min.js\"></script>\n\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/cdn/moment_js-ja.js\" style=\"display: none !important;\"></script>\n\t<script style=\"display: none !important;\">\n\t\tvar LANG = \"en\";\n\t\tvar userScreenName = \"\";\n\t\tvar csrfToken = \"zLZvYakBnLNaOQB4LUSuct8XO3Ly/jd4xeW25vRtvWY=\"\n\t</script>\n\t<script style=\"display: none !important;\" src=\"//img.atcoder.jp/public/e93c8b9/js/utils.js\"></script>\n\t\n\t\n\t\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/contest.js\" style=\"display: none !important;\"></script>\n\t\t<link rel=\"stylesheet\" href=\"//img.atcoder.jp/public/e93c8b9/css/contest.css\" style=\"display: none !important;\">\n\t\t<script style=\"display: none !important;\">\n\t\t\tvar contestScreenName = \"arc115\";\n\t\t\tvar remainingText = \"Remaining Time\";\n\t\t\tvar countDownText = \"Contest begins in\";\n\t\t\tvar startTime = moment(\"2021-03-21T20:00:00+09:00\");\n\t\t\tvar endTime = moment(\"2021-03-21T22:00:00+09:00\");\n\t\t</script>\n\t\t<style style=\"display: none !important;\"></style>\n\t\n\t\n\t\t<script type=\"text/x-mathjax-config\" style=\"display: none !important;\">MathJax.Hub.Config({messageStyle:\"none\",tex2jax:{skipTags:[\"script\",\"noscript\",\"style\",\"textarea\",\"code\"],inlineMath:[['\\\\(','\\\\)']]},delayStartupUntil:\"onload\"});</script>\n\t\t<script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML\" style=\"display: none !important;\"></script>\n\t\t<script style=\"display: none !important;\">$(function(){$('var').each(function(){var html=$(this).html().replace(/<sub>/g,'_{').replace(/<\\/sub>/g,'}');$(this).html('\\\\('+html+'\\\\)');});});</script>\n\t\n\t\n\t\t<link rel=\"stylesheet\" style=\"display: none !important;\" href=\"//img.atcoder.jp/public/e93c8b9/css/cdn/select2.min.css\">\n\t\t<link href=\"https://img.atcoder.jp/public/e93c8b9/css/cdn/select2-bootstrap.min.css\" rel=\"stylesheet\" style=\"display: none !important;\">\n\t\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/lib/select2.min.js\" style=\"display: none !important;\"></script>\n\t\n\t\n\t\t<link href=\"//img.atcoder.jp/public/e93c8b9/css/cdn/codemirror.min.css\" rel=\"stylesheet\" style=\"display: none !important;\">\n\t\t<script style=\"display: none !important;\" src=\"//img.atcoder.jp/public/e93c8b9/js/cdn/codemirror.min.js\"></script>\n\t\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/codeMirror/merged.js\" style=\"display: none !important;\"></script>\n\t\n\t\n\t\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/cdn/run_prettify.js\" style=\"display: none !important;\"></script>\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t<script style=\"display: none !important;\" src=\"//img.atcoder.jp/public/e93c8b9/js/base.js\"></script>\n\t<script src=\"//img.atcoder.jp/public/e93c8b9/js/ga.js\" style=\"display: none !important;\"></script>\n</head>\n\n<body>\n\n<script style=\"display: none !important;\" type=\"text/javascript\">\n\tvar __pParams = __pParams || [];\n\t__pParams.push({client_id: '468', c_1: 'atcodercontest', c_2: 'ClientSite'});\n</script>\n<script type=\"text/javascript\" src=\"https://cdn.d2-apps.net/js/tr.js\" style=\"display: none !important;\" async=\"\"></script>\n\n\n<div tabindex=\"-1\" role=\"dialog\" class=\"modal fade\" style=\"display: none !important;\" id=\"modal-contest-start\">\n\t<div class=\"modal-dialog\" role=\"document\" style=\"display: none !important;\">\n\t\t<div style=\"display: none !important;\" class=\"modal-content\">\n\t\t\t<div class=\"modal-header\" style=\"display: none !important;\">\n\t\t\t\t<button class=\"close\" aria-label=\"Close\" style=\"display: none !important;\" data-dismiss=\"modal\" type=\"button\"><span aria-hidden=\"true\" style=\"display: none !important;\">×</span></button>\n\t\t\t\t<h4 style=\"display: none !important;\" class=\"modal-title\">Contest started</h4>\n\t\t\t</div>\n\t\t\t<div class=\"modal-body\" style=\"display: none !important;\">\n\t\t\t\t<p style=\"display: none !important;\">AtCoder Regular Contest 115 has begun.</p>\n\t\t\t</div>\n\t\t\t<div class=\"modal-footer\" style=\"display: none !important;\">\n\t\t\t\t\n\t\t\t\t\t<button class=\"btn btn-default\" type=\"button\" style=\"display: none !important;\" data-dismiss=\"modal\">Close</button>\n\t\t\t\t\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div style=\"display: none !important;\" role=\"dialog\" tabindex=\"-1\" id=\"modal-contest-end\" class=\"modal fade\">\n\t<div class=\"modal-dialog\" style=\"display: none !important;\" role=\"document\">\n\t\t<div style=\"display: none !important;\" class=\"modal-content\">\n\t\t\t<div class=\"modal-header\" style=\"display: none !important;\">\n\t\t\t\t<button aria-label=\"Close\" style=\"display: none !important;\" type=\"button\" data-dismiss=\"modal\" class=\"close\"><span aria-hidden=\"true\" style=\"display: none !important;\">×</span></button>\n\t\t\t\t<h4 class=\"modal-title\" style=\"display: none !important;\">Contest is over</h4>\n\t\t\t</div>\n\t\t\t<div class=\"modal-body\" style=\"display: none !important;\">\n\t\t\t\t<p style=\"display: none !important;\">AtCoder Regular Contest 115 has ended.</p>\n\t\t\t</div>\n\t\t\t<div style=\"display: none !important;\" class=\"modal-footer\">\n\t\t\t\t<button style=\"display: none !important;\" type=\"button\" data-dismiss=\"modal\" class=\"btn btn-default\">Close</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div id=\"main-div\" class=\"float-container\">\n\n\n\t<nav style=\"display: none !important;\" class=\"navbar navbar-inverse navbar-fixed-top\">\n\t\t<div class=\"container-fluid\" style=\"display: none !important;\">\n\t\t\t<div class=\"navbar-header\" style=\"display: none !important;\">\n\t\t\t\t<button data-toggle=\"collapse\" aria-expanded=\"false\" style=\"display: none !important;\" class=\"navbar-toggle collapsed\" data-target=\"#navbar-collapse\" type=\"button\">\n\t\t\t\t\t<span class=\"icon-bar\" style=\"display: none !important;\"></span><span style=\"display: none !important;\" class=\"icon-bar\"></span><span style=\"display: none !important;\" class=\"icon-bar\"></span>\n\t\t\t\t</button>\n\t\t\t\t<a href=\"/home\" class=\"navbar-brand\" style=\"display: none !important;\"></a>\n\t\t\t</div>\n\t\t\t<div class=\"collapse navbar-collapse\" id=\"navbar-collapse\" style=\"display: none !important;\">\n\t\t\t\t<ul style=\"display: none !important;\" class=\"nav navbar-nav\">\n\t\t\t\t\n\t\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/contests/arc115\" class=\"contest-title\">AtCoder Regular Contest 115</a></li>\n\t\t\t\t\n\t\t\t\t</ul>\n\t\t\t\t<ul class=\"nav navbar-nav navbar-right\" style=\"display: none !important;\">\n\t\t\t\t\t\n\t\t\t\t\t<li style=\"display: none !important;\" class=\"dropdown\">\n\t\t\t\t\t\t<a data-toggle=\"dropdown\" href=\"#\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\" style=\"display: none !important;\" class=\"dropdown-toggle\">\n\t\t\t\t\t\t\t<img style=\"display: none !important;\" src=\"//img.atcoder.jp/assets/top/img/flag-lang/en.png\"> English <span class=\"caret\" style=\"display: none !important;\"></span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<ul style=\"display: none !important;\" class=\"dropdown-menu\">\n\t\t\t\t\t\t\t<li style=\"display: none !important;\"><a href=\"/contests/arc115/tasks/arc115_f?lang=ja\" style=\"display: none !important;\"><img style=\"display: none !important;\" src=\"//img.atcoder.jp/assets/top/img/flag-lang/ja.png\"> 日本語</a></li>\n\t\t\t\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/contests/arc115/tasks/arc115_f?lang=en\"><img style=\"display: none !important;\" src=\"//img.atcoder.jp/assets/top/img/flag-lang/en.png\"> English</a></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</li>\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t<li style=\"display: none !important;\"><a href=\"/register?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc115%2Ftasks%2Farc115_f\" style=\"display: none !important;\">Sign Up</a></li>\n\t\t\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/login?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc115%2Ftasks%2Farc115_f\">Sign In</a></li>\n\t\t\t\t\t\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</nav>\n\n\t<form name=\"form_logout\" action=\"/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc115%2Ftasks%2Farc115_f\" style=\"display: none !important;\" method=\"POST\">\n\t\t<input type=\"hidden\" value=\"zLZvYakBnLNaOQB4LUSuct8XO3Ly/jd4xeW25vRtvWY=\" name=\"csrf_token\" style=\"display: none !important;\">\n\t</form>\n\t<div class=\"container\" id=\"main-container\" style=\"padding-top:50px;\">\n\t\t\n\n\n<div class=\"row\">\n\t<div style=\"display: none !important;\" id=\"contest-nav-tabs\" class=\"col-sm-12 mb-2 cnvtb-fixed\">\n\t<div style=\"display: none !important;\">\n\t\t<small class=\"contest-duration\" style=\"display: none !important;\">\n\t\t\t\n\t\t\t\tContest Duration:\n\t\t\t\t<a target=\"blank\" style=\"display: none !important;\" href=\"http://www.timeanddate.com/worldclock/fixedtime.html?iso=20210321T2000&amp;p1=248\"><time class=\"fixtime fixtime-full\" style=\"display: none !important;\">2021-03-21 20:00:00+0900</time></a> - <a target=\"blank\" style=\"display: none !important;\" href=\"http://www.timeanddate.com/worldclock/fixedtime.html?iso=20210321T2200&amp;p1=248\"><time class=\"fixtime fixtime-full\" style=\"display: none !important;\">2021-03-21 22:00:00+0900</time></a> (local time)\n\t\t\t\t(120 minutes)\n\t\t\t\n\t\t</small>\n\t\t<small class=\"back-to-home pull-right\" style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/home\">Back to Home</a></small>\n\t</div>\n\t<ul class=\"nav nav-tabs\" style=\"display: none !important;\">\n\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/contests/arc115\"><span style=\"display: none !important;\" class=\"glyphicon glyphicon-home\" aria-hidden=\"true\"></span> Top</a></li>\n\t\t\n\t\t\t<li style=\"display: none !important;\" class=\"active\"><a style=\"display: none !important;\" href=\"/contests/arc115/tasks\"><span style=\"display: none !important;\" class=\"glyphicon glyphicon-tasks\" aria-hidden=\"true\"></span> Tasks</a></li>\n\t\t\n\n\t\t\n\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/contests/arc115/clarifications\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\" style=\"display: none !important;\"></span> Clarifications <span class=\"badge\" style=\"display: none !important;\" id=\"clar-badge\"></span></a></li>\n\t\t\n\n\t\t\n\n\t\t\n\t\t\t<li style=\"display: none !important;\">\n\t\t\t\t<a role=\"button\" href=\"#\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\" style=\"display: none !important;\" class=\"dropdown-toggle\"><span style=\"display: none !important;\" class=\"glyphicon glyphicon-list\" aria-hidden=\"true\"></span> Results<span style=\"display: none !important;\" class=\"caret\"></span></a>\n\t\t\t\t<ul class=\"dropdown-menu\" style=\"display: none !important;\">\n\t\t\t\t\t<li style=\"display: none !important;\"><a href=\"/contests/arc115/submissions\" style=\"display: none !important;\"><span class=\"glyphicon glyphicon-globe\" aria-hidden=\"true\" style=\"display: none !important;\"></span> All Submissions</a></li>\n\t\t\t\t\t\n\t\t\t\t</ul>\n\t\t\t</li>\n\t\t\n\n\t\t\n\t\t\t\n\t\t\t\t\n\t\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/contests/arc115/standings\"><span style=\"display: none !important;\" class=\"glyphicon glyphicon-sort-by-attributes-alt\" aria-hidden=\"true\"></span> Standings</a></li>\n\t\t\t\t\n\t\t\t\n\t\t\t\t\n\t\t\t\t\t<li style=\"display: none !important;\"><a href=\"/contests/arc115/standings/virtual\" style=\"display: none !important;\"><span aria-hidden=\"true\" style=\"display: none !important;\" class=\"glyphicon glyphicon-sort-by-attributes-alt\"></span> Virtual Standings</a></li>\n\t\t\t\t\n\t\t\t\n\t\t\n\n\t\t\n\n\t\t\n\t\t\t<li style=\"display: none !important;\"><a href=\"/contests/arc115/editorial\" style=\"display: none !important;\"><span aria-hidden=\"true\" class=\"glyphicon glyphicon-book\" style=\"display: none !important;\"></span> Editorial</a></li>\n\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\t\t\t<li style=\"display: none !important;\"><a target=\"_blank\" rel=\"noopener\" href=\"https://codeforces.com/blog/entry/88830\" style=\"display: none !important;\"><span aria-hidden=\"true\" class=\"glyphicon glyphicon-comment\" style=\"display: none !important;\"></span> Discuss</a></li>\n\t\t\t\n\t\t\n\n\t\t<li style=\"display: none !important;\" class=\"pull-right\"><a href=\"javascript:void(0)\" id=\"fix-cnvtb\" style=\"display: none !important;\"><span style=\"display: none !important;\" aria-hidden=\"true\" class=\"glyphicon glyphicon-pushpin\"></span></a></li>\n\t</ul>\n</div>\n\t<div class=\"col-sm-12\">\n\t\t<span class=\"h2\">\n\t\t\tF - Migration\n\t\t\t<a class=\"btn btn-default btn-sm\" href=\"/contests/arc115/tasks/arc115_f/editorial\">Editorial</a>\n\t\t</span>\n\t\t<span id=\"task-lang-btn\" class=\"pull-right\"><span data-lang=\"ja\"><img src=\"//img.atcoder.jp/assets/top/img/flag-lang/ja.png\"></span> / <span data-lang=\"en\"><img src=\"//img.atcoder.jp/assets/top/img/flag-lang/en.png\"></span></span>\n\t\t<script>\n\t\t\t$(function() {\n\t\t\t\tvar ts = $('#task-statement span.lang');\n\t\t\t\tif (ts.children('span').size() <= 1) {\n\t\t\t\t\t$('#task-lang-btn').hide();\n\t\t\t\t\tts.children('span').show();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar REMEMBER_LB = 5;\n\t\t\t\tvar LS_KEY = 'task_lang';\n\t\t\t\tvar taskLang = getLS(LS_KEY) || '';\n\t\t\t\tvar changeTimes = 0;\n\t\t\t\tif (taskLang == 'ja' || taskLang == 'en') {\n\t\t\t\t\tchangeTimes = REMEMBER_LB;\n\t\t\t\t} else {\n\t\t\t\t\tvar changeTimes = parseInt(taskLang, 10);\n\t\t\t\t\tif (isNaN(changeTimes)) {\n\t\t\t\t\t\tchangeTimes = 0;\n\t\t\t\t\t\tdelLS(LS_KEY);\n\t\t\t\t\t}\n\t\t\t\t\tchangeTimes++;\n\t\t\t\t\ttaskLang = LANG;\n\t\t\t\t}\n\t\t\t\tts.children('span.lang-' + taskLang).show();\n\n\t\t\t\t$('#task-lang-btn span').click(function() {\n\t\t\t\t\tvar l = $(this).data('lang');\n\t\t\t\t\tts.children('span').hide();\n\t\t\t\t\tts.children('span.lang-' + l).show();\n\t\t\t\t\tif (changeTimes < REMEMBER_LB) setLS(LS_KEY, changeTimes);\n\t\t\t\t\telse setLS(LS_KEY, l);\n\t\t\t\t});\n\t\t\t});\n\t\t</script>\n\t\t<hr>\n\t\t<p>\n\t\t\tTime Limit: 4 sec / Memory Limit: 1024 MB\n\t\t\t\n\t\t</p>\n\n\t\t<div id=\"task-statement\">\n\t\t\t\n\t\t\t<span class=\"lang\">\n<span class=\"lang-ja\" style=\"display: none !important;\">\n<p style=\"display: none !important;\">配点 : <var style=\"display: none !important;\">\\(1000\\)</var> 点</p>\n\n<div style=\"display: none !important;\" class=\"part\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">問題文</h3><p style=\"display: none !important;\"><var style=\"display: none !important;\">\\(N\\)</var> 頂点の木が与えられます。頂点には <var style=\"display: none !important;\">\\(1, \\ldots,N\\)</var> の番号がついており、<var style=\"display: none !important;\">\\(i\\)</var> 番目の辺は頂点 <var style=\"display: none !important;\">\\(u_i\\)</var> と頂点 <var style=\"display: none !important;\">\\(v_i\\)</var> をつないでいます。また、頂点 <var style=\"display: none !important;\">\\(i\\)</var> には整数 <var style=\"display: none !important;\">\\(h_i\\)</var> が書かれています。<br style=\"display: none !important;\">\n駒が <var style=\"display: none !important;\">\\(K\\)</var> 個あり、<var style=\"display: none !important;\">\\(i\\)</var> 番目の駒ははじめ頂点 <var style=\"display: none !important;\">\\(s_i\\)</var> に置かれています。あなたはこれから「一つ駒を選び、それが現在置かれている頂点に隣接するいずれかの頂点に移動させる」という操作を繰り返します。\n各駒 <var style=\"display: none !important;\">\\(i\\)</var> が頂点 <var style=\"display: none !important;\">\\(t_i\\)</var> に置かれている状態になったら操作を終了します。各駒 <var style=\"display: none !important;\">\\(i\\)</var> を頂点 <var style=\"display: none !important;\">\\(s_i\\)</var> から頂点 <var style=\"display: none !important;\">\\(t_i\\)</var> へ最短経路で移動させる必要は<strong style=\"display: none !important;\">ありません</strong>。<br style=\"display: none !important;\">\nある駒の配置に対して、それぞれの駒が置かれている頂点に書かれた整数を足し合わせた値を<strong style=\"display: none !important;\">ポテンシャル</strong>と呼ぶことにします。ただし、同じ頂点に複数の駒がある場合、その頂点の整数はその駒の個数だけ足し合わせるものとします。<br style=\"display: none !important;\">\n操作を通してのポテンシャルの最大値は最小でいくつになるか求めてください。ただし、はじめの状態と終わりの状態も考えるものとします。</p>\n</section>\n</div>\n\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">制約</h3><ul style=\"display: none !important;\">\n<li style=\"display: none !important;\"><var style=\"display: none !important;\">\\(1 \\leq N,K \\leq 2000\\)</var></li>\n<li style=\"display: none !important;\"><var style=\"display: none !important;\">\\(1 \\leq u_i,v_i \\leq N\\)</var></li>\n<li style=\"display: none !important;\"><var style=\"display: none !important;\">\\(1 \\leq h_i \\leq 10^9\\)</var></li>\n<li style=\"display: none !important;\"><var style=\"display: none !important;\">\\(1 \\leq s_i,t_i \\leq N\\)</var></li>\n<li style=\"display: none !important;\">与えられるグラフは木</li>\n</ul>\n</section>\n</div>\n\n<hr style=\"display: none !important;\">\n<div class=\"io-style\" style=\"display: none !important;\">\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">入力</h3><p style=\"display: none !important;\">入力は以下の形式で標準入力から与えられる。</p>\n<pre style=\"display: none !important;\"><var style=\"display: none !important;\">\\(N\\)</var>\n<var style=\"display: none !important;\">\\(h_1\\)</var> <var style=\"display: none !important;\">\\(h_2\\)</var> <var style=\"display: none !important;\">\\(\\ldots\\)</var> <var style=\"display: none !important;\">\\(h_N\\)</var>\n<var style=\"display: none !important;\">\\(u_1\\)</var> <var style=\"display: none !important;\">\\(v_1\\)</var>\n<var style=\"display: none !important;\">\\(u_2\\)</var> <var style=\"display: none !important;\">\\(v_2\\)</var>\n<var style=\"display: none !important;\">\\(:\\)</var>\n<var style=\"display: none !important;\">\\(u_{N-1}\\)</var> <var style=\"display: none !important;\">\\(v_{N-1}\\)</var>\n<var style=\"display: none !important;\">\\(K\\)</var>\n<var style=\"display: none !important;\">\\(s_1\\)</var> <var style=\"display: none !important;\">\\(t_1\\)</var>\n<var style=\"display: none !important;\">\\(s_2\\)</var> <var style=\"display: none !important;\">\\(t_2\\)</var>\n<var style=\"display: none !important;\">\\(:\\)</var>\n<var style=\"display: none !important;\">\\(s_K\\)</var> <var style=\"display: none !important;\">\\(t_K\\)</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">出力</h3><p style=\"display: none !important;\">答えを出力せよ。</p>\n</section>\n</div>\n</div>\n\n<hr style=\"display: none !important;\">\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">入力例 1</h3><pre style=\"display: none !important;\">3\n1 3 2\n1 2\n2 3\n2\n1 3\n3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">出力例 1</h3><pre style=\"display: none !important;\">4\n</pre>\n\n<p style=\"display: none !important;\">以下のように操作をすることで操作を通してのポテンシャルの最大値は <var style=\"display: none !important;\">\\(4\\)</var> となります。</p>\n<ul style=\"display: none !important;\">\n<li style=\"display: none !important;\">はじめ、ポテンシャルは <var style=\"display: none !important;\">\\(3\\)</var>。</li>\n<li style=\"display: none !important;\">駒 <var style=\"display: none !important;\">\\(2\\)</var> を頂点 <var style=\"display: none !important;\">\\(2\\)</var> に移動させる。ポテンシャルは <var style=\"display: none !important;\">\\(4\\)</var> になる。</li>\n<li style=\"display: none !important;\">駒 <var style=\"display: none !important;\">\\(2\\)</var> を頂点 <var style=\"display: none !important;\">\\(1\\)</var> に移動させる。ポテンシャルは <var style=\"display: none !important;\">\\(2\\)</var> になる。</li>\n<li style=\"display: none !important;\">駒 <var style=\"display: none !important;\">\\(1\\)</var> を頂点 <var style=\"display: none !important;\">\\(2\\)</var> に移動させる。ポテンシャルは <var style=\"display: none !important;\">\\(4\\)</var> になる。</li>\n<li style=\"display: none !important;\">駒 <var style=\"display: none !important;\">\\(1\\)</var> を頂点 <var style=\"display: none !important;\">\\(3\\)</var> に移動させる。ポテンシャルは <var style=\"display: none !important;\">\\(3\\)</var> になる。</li>\n</ul>\n<p style=\"display: none !important;\">ポテンシャルの最大値が <var style=\"display: none !important;\">\\(4\\)</var> より小さくなるような操作の方法は存在しないため、<var style=\"display: none !important;\">\\(4\\)</var> が答えです。</p>\n</section>\n</div>\n\n<hr style=\"display: none !important;\">\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">入力例 2</h3><pre style=\"display: none !important;\">7\n100 101 1 100 101 1 1000\n1 2\n2 3\n4 5\n5 6\n1 7\n4 7\n2\n1 3\n4 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">出力例 2</h3><pre style=\"display: none !important;\">201\n</pre>\n\n</section>\n</div>\n\n<hr style=\"display: none !important;\">\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">入力例 3</h3><pre style=\"display: none !important;\">5\n2 1 100 5 6\n1 2\n2 3\n3 4\n3 5\n2\n2 2\n4 5\n</pre>\n\n</section>\n</div>\n\n<div style=\"display: none !important;\" class=\"part\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">出力例 3</h3><pre style=\"display: none !important;\">101\n</pre>\n\n</section>\n</div>\n\n<hr style=\"display: none !important;\">\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">入力例 4</h3><pre style=\"display: none !important;\">4\n1 2 3 100\n1 4\n2 4\n3 4\n9\n1 1\n1 2\n1 3\n2 1\n2 2\n2 3\n3 1\n3 2\n3 3\n</pre>\n\n</section>\n</div>\n\n<div style=\"display: none !important;\" class=\"part\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">出力例 4</h3><pre style=\"display: none !important;\">115\n</pre>\n\n</section>\n</div>\n\n<hr style=\"display: none !important;\">\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">入力例 5</h3><pre style=\"display: none !important;\">6\n1 100 1 1 10 1000\n1 2\n2 3\n4 5\n1 6\n4 6\n3\n1 3\n5 5\n5 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\" style=\"display: none !important;\">\n<section style=\"display: none !important;\">\n<h3 style=\"display: none !important;\">出力例 5</h3><pre style=\"display: none !important;\">102\n</pre></section>\n</div>\n</span>\n<span class=\"lang-en\">\n<p>Score : <var>\\(1000\\)</var> points</p>\n\n<div class=\"part\">\n<section>\n<h3>Problem Statement</h3><p>Given is a tree with <var>\\(N\\)</var> vertices numbered <var>\\(1, \\ldots, N\\)</var>. The <var>\\(i\\)</var>-th edge connects Vertex <var>\\(u_i\\)</var> and Vertex <var>\\(v_i\\)</var>. Additionally, Vertex <var>\\(i\\)</var> has an integer <var>\\(h_i\\)</var> written on it. <br>\nWe have <var>\\(K\\)</var> pieces, the <var>\\(i\\)</var>-th of which is initially on Vertex <var>\\(s_i\\)</var>. You will repeat the following operation: choose a piece and move it to one of the vertices adjacent to the vertex the piece is currently on.\nYou will end this process when each piece <var>\\(i\\)</var> is on Vertex <var>\\(t_i\\)</var>. It is <strong>not</strong> required for each piece <var>\\(i\\)</var> to go along the shortest path from Vertex <var>\\(s_i\\)</var> to Vertex <var>\\(t_i\\)</var>. <br>\nFor an arrangement of the pieces, let its <strong>potential</strong> be the sum of the integers written on the vertices the pieces are on. If multiple pieces are on the same vertex, the integer on that vertex is added the number of times equal to that number of pieces. <br>\nFind the minimum possible value of the maximum potential during the process, including the initial and final states.</p>\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Constraints</h3><ul>\n<li><var>\\(1 \\leq N,K \\leq 2000\\)</var></li>\n<li><var>\\(1 \\leq u_i,v_i \\leq N\\)</var></li>\n<li><var>\\(1 \\leq h_i \\leq 10^9\\)</var></li>\n<li><var>\\(1 \\leq s_i,t_i \\leq N\\)</var></li>\n<li>The given graph is a tree.</li>\n</ul>\n</section>\n</div>\n\n<hr>\n<div class=\"io-style\">\n<div class=\"part\">\n<section>\n<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>\n<pre><var>\\(N\\)</var>\n<var>\\(h_1\\)</var> <var>\\(h_2\\)</var> <var>\\(\\ldots\\)</var> <var>\\(h_N\\)</var>\n<var>\\(u_1\\)</var> <var>\\(v_1\\)</var>\n<var>\\(u_2\\)</var> <var>\\(v_2\\)</var>\n<var>\\(:\\)</var>\n<var>\\(u_{N-1}\\)</var> <var>\\(v_{N-1}\\)</var>\n<var>\\(K\\)</var>\n<var>\\(s_1\\)</var> <var>\\(t_1\\)</var>\n<var>\\(s_2\\)</var> <var>\\(t_2\\)</var>\n<var>\\(:\\)</var>\n<var>\\(s_K\\)</var> <var>\\(t_K\\)</var>\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Output</h3><p>Print the answer.</p>\n</section>\n</div>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 1</h3><pre>3\n1 3 2\n1 2\n2 3\n2\n1 3\n3 1\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 1</h3><pre>4\n</pre>\n\n<p>We can make <var>\\(4\\)</var> the maximum potential during the process, as follows:</p>\n<ul>\n<li>Initially, the potential is <var>\\(3\\)</var>.</li>\n<li>Move Piece <var>\\(2\\)</var> to Vertex <var>\\(2\\)</var>. The potential is now <var>\\(4\\)</var>.</li>\n<li>Move Piece <var>\\(2\\)</var> to Vertex <var>\\(1\\)</var>. The potential is now <var>\\(2\\)</var>.</li>\n<li>Move Piece <var>\\(1\\)</var> to Vertex <var>\\(2\\)</var>. The potential is now <var>\\(4\\)</var>.</li>\n<li>Move Piece <var>\\(1\\)</var> to Vertex <var>\\(3\\)</var>. The potential is now <var>\\(3\\)</var>.</li>\n</ul>\n<p>There is no way to make the maximum potential during the process less than <var>\\(4\\)</var>, so the answer is <var>\\(4\\)</var>.</p>\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 2</h3><pre>7\n100 101 1 100 101 1 1000\n1 2\n2 3\n4 5\n5 6\n1 7\n4 7\n2\n1 3\n4 6\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 2</h3><pre>201\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 3</h3><pre>5\n2 1 100 5 6\n1 2\n2 3\n3 4\n3 5\n2\n2 2\n4 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 3</h3><pre>101\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 4</h3><pre>4\n1 2 3 100\n1 4\n2 4\n3 4\n9\n1 1\n1 2\n1 3\n2 1\n2 2\n2 3\n3 1\n3 2\n3 3\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 4</h3><pre>115\n</pre>\n\n</section>\n</div>\n\n<hr>\n<div class=\"part\">\n<section>\n<h3>Sample Input 5</h3><pre>6\n1 100 1 1 10 1000\n1 2\n2 3\n4 5\n1 6\n4 6\n3\n1 3\n5 5\n5 5\n</pre>\n\n</section>\n</div>\n\n<div class=\"part\">\n<section>\n<h3>Sample Output 5</h3><pre>102\n</pre></section>\n</div>\n</span>\n</span>\n\n\t\t</div>\n\n\t\t\n\n\t\t\n\t</div>\n</div>\n\n\n\n\n\t\t\n\t\t\t<hr style=\"display: none !important;\">\n\t\t\t\n\t\t\t\n\t\t\t\n<div data-a2a-title=\"F - Migration\" data-a2a-url=\"https://atcoder.jp/contests/arc115/tasks/arc115_f?lang=en\" class=\"a2a_kit a2a_kit_size_20 a2a_default_style pull-right\" style=\"display: none !important;\">\n\t<a style=\"display: none !important;\" class=\"a2a_button_facebook\"></a>\n\t<a class=\"a2a_button_twitter\" style=\"display: none !important;\"></a>\n\t\n\t\t<a style=\"display: none !important;\" class=\"a2a_button_telegram\"></a>\n\t\n\t<a href=\"https://www.addtoany.com/share\" class=\"a2a_dd\" style=\"display: none !important;\"></a>\n</div>\n\n\t\t\n\t\t<script async=\"\" src=\"//static.addtoany.com/menu/page.js\" style=\"display: none !important;\"></script>\n\t\t\n\t</div> \n\t<hr style=\"display: none !important;\">\n</div> \n\n\t<div class=\"container\" style=\"margin-bottom: 80px;display: none !important;\">\n\t\t\t<footer style=\"display: none !important;\" class=\"footer\">\n\t\t\t\n\t\t\t\t<ul style=\"display: none !important;\">\n\t\t\t\t\t<li style=\"display: none !important;\"><a href=\"/contests/arc115/rules\" style=\"display: none !important;\">Rule</a></li>\n\t\t\t\t\t<li style=\"display: none !important;\"><a href=\"/contests/arc115/glossary\" style=\"display: none !important;\">Glossary</a></li>\n\t\t\t\t\t\n\t\t\t\t</ul>\n\t\t\t\n\t\t\t<ul style=\"display: none !important;\">\n\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/tos\">Terms of service</a></li>\n\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/privacy\">Privacy Policy</a></li>\n\t\t\t\t<li style=\"display: none !important;\"><a href=\"/personal\" style=\"display: none !important;\">Information Protection Policy</a></li>\n\t\t\t\t<li style=\"display: none !important;\"><a href=\"/company\" style=\"display: none !important;\">Company</a></li>\n\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/faq\">FAQ</a></li>\n\t\t\t\t<li style=\"display: none !important;\"><a style=\"display: none !important;\" href=\"/contact\">Contact</a></li>\n\t\t\t\t\n\t\t\t</ul>\n\t\t\t<div style=\"display: none !important;\" class=\"text-center\">\n\t\t\t\t\t<small style=\"display: none !important;\" id=\"copyright\">Copyright Since 2012 ©<a style=\"display: none !important;\" href=\"http://atcoder.co.jp\">AtCoder Inc.</a> All rights reserved.</small>\n\t\t\t</div>\n\t\t\t</footer>\n\t</div>\n\t<p id=\"fixed-server-timer\" class=\"contest-timer\" style=\"display: none !important;\"></p>\n\t<div id=\"scroll-page-top\" style=\"display:none;display: none !important;\"><span style=\"display: none !important;\" aria-hidden=\"true\" class=\"glyphicon glyphicon-arrow-up\"></span> Page Top</div>\n\n\n\n\n\n</body></html>"}}}